/* ================================================================
   HWP Writer — Obsidian Plugin Styles
   마크다운ㅎ글 스타일을 Obsidian에 맞게 구현
   ================================================================ */

/* ── 변수 ── */
:root {
  --hwp-primary: #1a73e8;
  --hwp-primary-hover: #1557b0;
  --hwp-toolbar-bg: #38a9ff;
  --hwp-toolbar-border: var(--background-modifier-border);
  --hwp-toolbar-btn-hover: var(--background-modifier-hover);
  --hwp-toolbar-btn-active: var(--interactive-accent);
  --hwp-toolbar-btn-text: var(--text-normal);
  --hwp-toolbar-logo-size: clamp(24px, 3vw, 40px);
  --hwp-toolbar-logo-right: clamp(8px, 1.2vw, 16px);
  --hwp-toolbar-logo-top: clamp(3px, 0.5vw, 7px);
  --hwp-paper-bg: #ffffff;
  --hwp-paper-shadow: 0 2px 8px rgba(0, 0, 0, 0.12);
  --hwp-paper-border: #d0d0d0;
}

.theme-dark {
  --hwp-paper-bg: #f8f8f8;
  --hwp-paper-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
  --hwp-paper-border: #555;
}

/* ================================================================
   HWP TOOLBAR — 마크다운 에디터 내부에 삽입되는 DOM 툴바
   ================================================================ */

.hwp-toolbar-container {
  position: sticky;
  top: 0;
  z-index: 10;
  background: var(--hwp-toolbar-bg);
  border-bottom: 2px solid var(--hwp-primary);
  padding: 2px 6px;
  padding-right: calc(var(--hwp-toolbar-logo-size) + var(--hwp-toolbar-logo-right) + 10px);
  flex-shrink: 0;
  user-select: none;
  min-height: unset !important;
}

.hwp-toolbar-container::after {
  content: "";
  position: absolute;
  top: var(--hwp-toolbar-logo-top);
  right: var(--hwp-toolbar-logo-right);
  width: var(--hwp-toolbar-logo-size);
  height: var(--hwp-toolbar-logo-size);
  background: url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNTYiIGhlaWdodD0iMjU2IiB2ZXJzaW9uPSIyLjAiIHZpZXdCb3g9IjAgMCAyNTYgMjU2Ij48cGF0aCBmaWxsPSIjOThEMEY1IiBkPSJNMTI4IDI0Ny45OWg5OC4xODJjMTIuMDUgMCAyMS44MTgtOS43NjggMjEuODE4LTIxLjgxOHYtMzguMTlIMTI4djYwLjAwOFoiLz48cGF0aCBmaWxsPSJ1cmwoI2EpIiBkPSJNMTI4IDE4OC4wMjZoMTIwdi02MC4wMDhIMTI4djYwLjAwOFoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMTI4IDEyOC4wMDhoMTIwVjY4SDEyOHY2MC4wMDhaIi8+PHBhdGggZmlsbD0idXJsKCNjKSIgZD0iTTEyOCA2OC4wMDhoMTIwdi0zOC4xOUMyNDggMTcuNzY4IDIzOC4yMzIgOCAyMjYuMTgyIDhIMTI4djYwLjAwOFoiLz48cGF0aCBmaWxsPSJ1cmwoI2QpIiBkPSJNMTI4IDI0OFY4aDQzLjYzN2MtMy4xMzUgMTguMzItMTAuNTIzIDYzLjY4MS0xNS44NTkgMTEzLjc3LTUuNjY3IDUzLjE4OS04LjI1MSAxMDcuOS05LjAxIDEyNi4yM0gxMjhaIi8+PHBhdGggZmlsbD0idXJsKCNlKSIgZD0iTTM4LjU0NSA4SDEyOHYyNDBIMzguNTQ2Yy04LjEyMiAwLTEyLjE4MyAwLTE1LjQ3LTEuMDY4YTIxLjgxOCAyMS44MTggMCAwIDEtMTQuMDA4LTE0LjAwOUM4IDIyOS42MzcgOCAyMjUuNTc3IDggMjE3LjQ1NFYzOC41NDVjMC04LjEyMiAwLTEyLjE4MyAxLjA2OC0xNS40NjlBMjEuODE5IDIxLjgxOSAwIDAgMSAyMy4wNzYgOS4wNjhDMjYuMzYzIDggMzAuNDI0IDggMzguNTQ2IDhaIi8+PHBhdGggZmlsbD0iI2ZmZiIgZD0iTTEwNC40NSA1Ni44MjRINzQuMjY5Yy4xMTktMS41MDYuMjM4LTQuMDg0LjIzOC03LjIxN3YtNy4xaC0xMi45N3Y3LjFjMCAzLjEzMy4xNiA1LjcxLjIzOSA3LjIxN0gzMS41NTVWNjkuMDRoMTUuMDNjLTQuODc3IDMuNjEtNy40OTUgOS41OTktNy40OTUgMTcuMTM0IDAgMTQuNDc2IDExLjUwMiAyNi4zMzQgMjguOTEyIDI2LjMzNCAxNy40MSAwIDI4LjkxMy0xMS44MTkgMjguOTEzLTI2LjMzNCAwLTcuNTc1LTMuMDE0LTEzLjc2My03LjQ5Ni0xNy4xMzRoMTUuMDMxVjU2LjgyNFptLTM2LjQ0OCA0My41MDhjLTkuMzk5IDAtMTUuOTQzLTcuMzM4LTE1Ljk0My0xNS45ODMgMC04LjY0NiA2LjU0NC0xNS45ODQgMTUuOTQzLTE1Ljk4NCA5LjQgMCAxNS45NDMgNy4zMzggMTUuOTQzIDE1Ljk4NCAwIDguNjQ1LTYuNTQzIDE1Ljk4My0xNS45NDMgMTUuOTgzWiIvPjxkZWZzPjxsaW5lYXJHcmFkaWVudCBpZD0iYSIgeDE9IjE4OCIgeDI9IjE4OCIgeTE9IjE4OC4wMjYiIHkyPSIxMjguMDE4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agc3RvcC1jb2xvcj0iIzM3QTVGQSIvPjxzdG9wIG9mZnNldD0iMC4xMTUwMTUiIHN0b3AtY29sb3I9IiM0MkFERkYiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjE4OCIgeDI9IjE4OCIgeTE9IjEyOC4wMDgiIHkyPSI2OCIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiMwMDdCRDkiLz48c3RvcCBvZmZzZXQ9IjAuMTI1MjY3IiBzdG9wLWNvbG9yPSIjMDA4MkU1Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImMiIHgxPSIxODgiIHgyPSIxODgiIHkxPSI2OC4wMDkyIiB5Mj0iOC4wMDExMSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiPjxzdG9wIHN0b3AtY29sb3I9IiMwMDQ1OEEiLz48c3RvcCBvZmZzZXQ9IjAuMTE0Njg5IiBzdG9wLWNvbG9yPSIjMDA0RDk5Ii8+PC9saW5lYXJHcmFkaWVudD48bGluZWFyR3JhZGllbnQgaWQ9ImQiIHgxPSIxMzAuNjgzIiB4Mj0iMTU2Ljg0OSIgeTE9IjcwLjYwODYiIHkyPSI3My4yMzI5IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agc3RvcC1vcGFjaXR5PSIwLjQ5Ii8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9IjAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iZSIgeDE9IjY4IiB4Mj0iNjgiIHkxPSI4IiB5Mj0iMjQ4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+PHN0b3Agc3RvcC1jb2xvcj0iIzQyQURGRiIvPjxzdG9wIG9mZnNldD0iMSIgc3RvcC1jb2xvcj0iIzMzQTdGRiIvPjwvbGluZWFyR3JhZGllbnQ+PC9kZWZzPjwvc3ZnPg==") center / contain no-repeat;
  pointer-events: none;
  z-index: 1;
}

.hwp-toolbar-main,
.hwp-toolbar-format {
  display: flex;
  align-items: center;
  gap: 2px;
  flex-wrap: wrap;
  min-height: 32px;
  padding: 2px 0;
}

.hwp-toolbar-group {
  display: flex;
  align-items: center;
  gap: 1px;
  flex-shrink: 0;
}

.hwp-toolbar-divider {
  width: 1px;
  height: 20px;
  background: var(--hwp-toolbar-border);
  margin: 0 4px;
  flex-shrink: 0;
}

/* 툴바 버튼 */
.hwp-toolbar-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  min-width: 28px;
  height: 26px;
  padding: 2px 6px;
  border: 2px solid #004d99;
  border-radius: 4px;
  background: transparent;
  color: var(--hwp-toolbar-btn-text);
  cursor: pointer;
  font-size: 12px;
  transition: background 0.1s;
}

.hwp-toolbar-btn:hover {
  background: var(--hwp-toolbar-btn-hover);
}

.hwp-toolbar-btn:active {
  background: var(--hwp-toolbar-btn-active);
  color: white;
}

.hwp-toolbar-btn.is-active {
  background: var(--hwp-primary);
  color: white;
}

.hwp-toolbar-btn svg {
  width: 16px;
  height: 16px;
}

.hwp-toolbar-btn-label {
  font-weight: 600;
  font-size: 11px;
  letter-spacing: -0.3px;
}

/* 드롭다운 메뉴 */
.hwp-toolbar-menu {
  position: relative;
}

.hwp-toolbar-menu-panel {
  position: absolute;
  top: calc(100% + 4px);
  left: 0;
  z-index: 30;
  min-width: 170px;
  max-width: 280px;
  max-height: 300px;
  overflow-y: auto;
  display: none;
  flex-direction: column;
  gap: 2px;
  padding: 6px;
  border: 2px solid #004d99;
  border-radius: 6px;
  background: var(--background-primary);
  box-shadow: 0 8px 18px rgba(0, 0, 0, 0.2);
}

.hwp-toolbar-menu.is-open .hwp-toolbar-menu-panel {
  display: flex;
}

.hwp-toolbar-menu-item {
  display: flex;
  align-items: center;
  gap: 6px;
  width: 100%;
  min-height: 28px;
  padding: 4px 8px;
  border: 1px solid var(--hwp-toolbar-border);
  border-radius: 4px;
  background: transparent;
  color: var(--text-normal);
  cursor: pointer;
  text-align: left;
  font-size: 12px;
}

.hwp-toolbar-menu-item:hover {
  background: var(--hwp-toolbar-btn-hover);
}

.hwp-toolbar-menu-item:active {
  background: var(--hwp-toolbar-btn-active);
  color: white;
}

.hwp-toolbar-menu-divider {
  height: 1px;
  background: var(--hwp-toolbar-border);
  margin: 4px 0;
}

/* 스타일 드롭다운 */
.hwp-style-dropdown {
  height: 26px;
  padding: 2px 8px;
  border: 2px solid #004d99;
  border-radius: 4px;
  background: var(--background-primary);
  color: var(--text-normal);
  font-size: 12px;
  cursor: pointer;
  min-width: 120px;
}

.hwp-style-dropdown:focus {
  border-color: var(--hwp-primary);
  outline: none;
}

/* ================================================================
   PREVIEW — A4 용지 뷰
   ================================================================ */

.hwp-preview-container {
  background: var(--background-secondary);
  padding: 24px;
  overflow: auto;
  display: flex;
  justify-content: center;
}

.hwp-paper-frame {
  width: max-content;
  max-width: 100%;
}

.hwp-paper {
  background: var(--hwp-paper-bg);
  box-shadow: var(--hwp-paper-shadow);
  border: 1px solid var(--hwp-paper-border);
  width: var(--hwp-paper-width, 595.3pt);
  min-height: var(--hwp-paper-height, 841.9pt);
  padding: var(--hwp-paper-padding, 42.6pt 72pt 49.6pt 72pt);
  box-sizing: border-box;
  /* Obsidian 전역 폰트 변수 무시 — HWP 템플릿 폰트가 최우선 */
  --font-text: unset;
  --font-text-override: unset;
  --font-interface: unset;
  --default-font: unset;
  font-family: serif;
  font-size: 10pt !important;
  line-height: 1.6;
  color: #1a1a1a;
  word-break: keep-all;
  overflow-wrap: break-word;
  display: flex;
  flex-direction: column;
}

/* HWP 레벨별 스타일 */
.hwp-line {
  margin: 0;
  padding: 0;
  /* 인라인 스타일의 font-family가 최우선 되도록 */
  font-family: inherit !important;
}

.hwp-line.hwp-empty {
  height: 1.2em;
}

.hwp-line.hwp-title {
  margin-top: 16px;
  margin-bottom: 8px;
}

.hwp-line.hwp-subtitle {
  margin-top: 12px;
  margin-bottom: 6px;
}

.hwp-line.hwp-note {
  color: #555;
}

.hwp-preview-empty {
  text-align: center;
  color: var(--text-muted);
  padding: 60px 20px;
  font-size: 14px;
}

/* ================================================================
   SETUP GUIDE MODAL (설치 가이드)
   ================================================================ */

.hwp-setup-guide {
  max-width: 640px;
  padding: 0 8px;
}

.hwp-setup-guide h1 {
  text-align: center;
  margin-bottom: 4px;
}

.hwp-setup-subtitle {
  text-align: center;
  color: var(--text-muted);
  font-size: 14px;
  margin-bottom: 20px;
}

.hwp-setup-step {
  margin-bottom: 24px;
  padding: 16px;
  background: var(--background-secondary);
  border-radius: 8px;
  border-left: 4px solid var(--hwp-primary);
}

.hwp-setup-step h2 {
  margin-top: 0;
  font-size: 16px;
}

.hwp-setup-step p {
  color: var(--text-muted);
  font-size: 13px;
  margin-bottom: 12px;
}

.hwp-setup-howto h3 {
  font-size: 13px;
  margin: 12px 0 6px;
  color: var(--text-normal);
}

.hwp-setup-howto ol {
  padding-left: 20px;
  font-size: 13px;
  line-height: 1.8;
}

.hwp-setup-howto ol li {
  margin-bottom: 4px;
}

.hwp-setup-howto a {
  color: var(--hwp-primary);
  text-decoration: underline;
}

.hwp-setup-warning {
  background: #fff3cd;
  border: 1px solid #ffc107;
  border-radius: 6px;
  padding: 8px 12px;
  font-size: 12px;
  margin-top: 8px;
  color: #856404;
}

.theme-dark .hwp-setup-warning {
  background: #3d3200;
  border-color: #665200;
  color: #ffd700;
}

.hwp-setup-cmd {
  background: var(--background-primary);
  border: 1px solid var(--hwp-toolbar-border);
  border-radius: 6px;
  padding: 10px 14px;
  margin: 8px 0;
  font-family: monospace;
}

.hwp-setup-cmd code {
  font-size: 13px;
  word-break: break-all;
}

.hwp-setup-copy-btn {
  display: inline-block;
  margin-top: 6px;
  padding: 4px 12px;
  font-size: 12px;
  border: 1px solid var(--hwp-toolbar-border);
  border-radius: 4px;
  background: var(--background-secondary);
  color: var(--text-normal);
  cursor: pointer;
}

.hwp-setup-copy-btn:hover {
  background: var(--background-modifier-hover);
}

/* 설치 상태 테이블 */
.hwp-setup-status {
  margin-bottom: 16px;
}

.hwp-setup-status h3 {
  font-size: 14px;
  margin-bottom: 8px;
}

.hwp-setup-status-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 13px;
}

.hwp-setup-status-table td {
  padding: 6px 10px;
  border-bottom: 1px solid var(--hwp-toolbar-border);
}

.hwp-setup-status-table td:first-child {
  font-weight: 600;
  width: 140px;
}

.hwp-status-ok {
  color: #28a745;
}

.hwp-status-fail {
  color: #dc3545;
}

.hwp-status-all-good {
  background: #d4edda;
  border-radius: 6px;
  padding: 10px 14px;
  margin-top: 12px;
  font-size: 13px;
  color: #155724;
}

.theme-dark .hwp-status-all-good {
  background: #1a3a1a;
  color: #7ddf7d;
}

.hwp-setup-done {
  text-align: center;
  padding: 16px;
  background: var(--background-secondary);
  border-radius: 8px;
  margin-top: 16px;
}

.hwp-setup-done h2 {
  margin-top: 0;
}

.hwp-setup-footer {
  margin-top: 16px;
  text-align: center;
}

/* ================================================================
   TEMPLATE / PRESET / STYLE MODALS
   ================================================================ */

.hwp-template-picker,
.hwp-preset-picker {
  max-width: 560px;
  padding: 0 8px;
}

.hwp-template-section {
  margin-bottom: 12px;
}

.hwp-template-picker h2,
.hwp-preset-picker h2 {
  margin-bottom: 4px;
}

.hwp-template-picker h3,
.hwp-preset-picker h3 {
  font-size: 14px;
  margin-top: 16px;
  margin-bottom: 8px;
  padding-bottom: 4px;
  border-bottom: 1px solid var(--hwp-toolbar-border);
}

/* 스타일 에디터 — 2칸 레이아웃 */
.hwp-style-editor {
  max-width: 1200px;
  width: 90vw;
  padding: 0 8px;
}

.hwp-style-editor-layout {
  display: flex;
  gap: 24px;
  align-items: flex-start;
}

.hwp-style-editor-controls {
  flex: 1;
  min-width: 0;
  overflow-y: auto;
  max-height: 70vh;
}

.hwp-style-editor-preview {
  width: 360px;
  flex-shrink: 0;
  position: sticky;
  top: 0;
}

.hwp-style-level-section {
  margin-bottom: 20px;
  padding: 12px 16px;
  background: var(--background-secondary);
  border-radius: 8px;
  border-left: 3px solid var(--hwp-primary);
}

.hwp-style-level-section h3 {
  margin-top: 0;
  font-size: 14px;
  margin-bottom: 8px;
}

.hwp-style-preview-box {
  background: var(--hwp-paper-bg);
  border: 1px solid var(--hwp-paper-border);
  border-radius: 6px;
  padding: 20px 24px;
  min-height: 200px;
  color: #1a1a1a;
  box-shadow: var(--hwp-paper-shadow);
}

.hwp-style-preview-line {
  margin: 0;
  padding: 2px 0;
}

/* 좁은 화면에서 1칸으로 */
@media (max-width: 700px) {
  .hwp-style-editor-layout {
    flex-direction: column;
  }

  .hwp-style-editor-preview {
    width: 100%;
    position: relative;
    order: -1;
  }
}

/* ================================================================
   STATUS BAR INDICATOR
   ================================================================ */

.hwp-status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  font-size: 11px;
}

.hwp-status-dot {
  width: 6px;
  height: 6px;
  border-radius: 50%;
  display: inline-block;
}

.hwp-status-dot.connected {
  background: #28a745;
}

.hwp-status-dot.disconnected {
  background: #dc3545;
}


